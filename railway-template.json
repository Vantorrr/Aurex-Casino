{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "services": {
    "database": {
      "image": "postgres:16-alpine",
      "env": {
        "POSTGRES_USER": "aurex",
        "POSTGRES_PASSWORD": {
          "generate": "password"
        },
        "POSTGRES_DB": "aurex_casino"
      }
    },
    "backend": {
      "root": "backend",
      "build": {
        "buildCommand": "npm install"
      },
      "start": {
        "command": "npm run setup && npm start"
      },
      "env": {
        "NODE_ENV": "production",
        "PORT": "6000",
        "DATABASE_URL": {
          "reference": "database.DATABASE_URL"
        },
        "JWT_SECRET": {
          "generate": "secret"
        },
        "FRONTEND_URL": {
          "reference": "frontend.url"
        }
      },
      "healthcheck": {
        "path": "/health",
        "timeout": 100
      }
    },
    "frontend": {
      "root": "frontend",
      "build": {
        "buildCommand": "npm install && npm run build"
      },
      "start": {
        "command": "npm start"
      },
      "env": {
        "NEXT_PUBLIC_API_URL": {
          "reference": "backend.url"
        },
        "NEXT_PUBLIC_SITE_URL": {
          "reference": "frontend.url"
        }
      }
    }
  }
}
